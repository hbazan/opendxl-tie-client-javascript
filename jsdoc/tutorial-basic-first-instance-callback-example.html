<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Tutorial: Basic First Instance Callback Example</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Tutorial: Basic First Instance Callback Example</h1>

    <section>

<header>
    

    <h2>Basic First Instance Callback Example</h2>
</header>

<article>
    <p>This sample demonstrates registering a callback with the DXL fabric to receive
<code>first instance</code> events sent by the McAfee Threat Intelligence Exchange (TIE)
DXL service when are encountered for the first time within the local enterprise.</p>
<h3>Prerequisites</h3><ul>
<li>The samples configuration step has been completed (see <a href="tutorial-samples.html">Samples</a>).</li>
<li>A McAfee Threat Intelligence Exchange (TIE) Service is available on the DXL
fabric.</li>
</ul>
<h3>Running</h3><p>To run this sample execute the
<code>sample/basic/basic-first-instance-callback-example.js</code> script as follows:</p>
<pre class="prettyprint source lang-sh"><code>$ node sample/basic/basic-first-instance-callback-example.js</code></pre><p>The output should appear similar to the following:</p>
<pre class="prettyprint source"><code>Waiting for first instance events...</code></pre><p>At this point the sample is listening for first instance events from the DXL
fabric.</p>
<h3>Execute New File</h3><p>Execute a file that has not been previously seen within the local enterprise.</p>
<h3>Detection Output</h3><p>After the file has executed the first instance information should appear within
the console that the sample is running (similar to the output below):</p>
<pre class="prettyprint source"><code>First instance on topic: /mcafee/event/tie/file/firstinstance
{
    &quot;agentGuid&quot;: &quot;{68125cd6-a5d8-11e6-348e-000c29663178}&quot;,
    &quot;hashes&quot;: {
        &quot;md5&quot;: &quot;31dbe8cc443d2ca7fd236ac00a52fb17&quot;,
        &quot;sha1&quot;: &quot;2d6ca45061b7972312e00e5933fdff95bb90b61b&quot;,
        &quot;sha256&quot;: &quot;aa3c461d4c21a392e372d0d6ca4ceb1e4d88098d587659454eaf4d93c661880f&quot;
    },
    &quot;name&quot;: &quot;MORPH.EXE&quot;
}</code></pre><p>The first line displays the DXL topic that the event was received on. In this
particular case it is, <code>&quot;/mcafee/event/tie/file/firstinstance&quot;</code>, which
indicates that this is a file first instance event.</p>
<p>The following information is included in the <code>first instance</code> object:</p>
<ul>
<li>System the first instance of the file was found on.</li>
<li>File information (file name and associated hashes).</li>
</ul>
<h3>Details</h3><p>The majority of the sample code is shown below:</p>
<pre class="prettyprint source lang-js"><code>// Create the client
var client = new dxl.Client(config)

// Connect to the fabric, supplying a callback function which is invoked
// when the connection has been established
client.connect(function () {
  // Create the McAfee Threat Intelligence Exchange (TIE) client
  var tieClient = new TieClient(client)

  // Register first instance callback with the client
  tieClient.addFileFirstInstanceCallback(
    function (firstInstanceObj, originalEvent) {
      // Display the DXL topic that the event was received on
      console.log('First instance on topic: ' + originalEvent.destinationTopic)
      // Dump the first instance info
      console.log(MessageUtils.objectToJson(firstInstanceObj, true))
    }
  )

  // Wait forever
  console.log('Waiting for first instance events...')
})</code></pre><p>Once a connection is established to the DXL fabric, the callback function
supplied to the DXL client instance's
<a href="https://opendxl.github.io/opendxl-client-javascript/jsdoc/Client.html#connect">connect()</a>
method will be invoked. From within the callback function, a <a href="TieClient.html">TieClient</a>
instance is created. The TieClient instance will be used to communicate with the
TIE DXL services.</p>
<p>Next, a call is made to the
<a href="TieClient.html#addFileFirstInstanceCallback">addFileFirstInstanceCallback()</a>
method to register a function to be invoked when first instance events occur.</p>
<p>When a new file is encountered within the local enterprise, the first instance
callback will display the topic that the event was received on. The first
instance details are printed by converting the <code>firstInstanceObj</code> object to JSON
with a call to the
<a href="https://opendxl.github.io/opendxl-bootstrap-javascript/jsdoc/module-MessageUtils.html#.objectToJson">MessageUtils.objectToJson()</a>
method.</p>
</article>

</section>

</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-AtdAttrib.html">AtdAttrib</a></li><li><a href="module-AtdTrustLevel.html">AtdTrustLevel</a></li><li><a href="module-CertEnterpriseAttrib.html">CertEnterpriseAttrib</a></li><li><a href="module-CertGtiAttrib.html">CertGtiAttrib</a></li><li><a href="module-CertProvider.html">CertProvider</a></li><li><a href="module-CertRepChangeEventProp.html">CertRepChangeEventProp</a></li><li><a href="module-CertReputationOverriddenProp.html">CertReputationOverriddenProp</a></li><li><a href="module-CertReputationProp.html">CertReputationProp</a></li><li><a href="module-DetectionEventProp.html">DetectionEventProp</a></li><li><a href="module-EpochUtil.html">EpochUtil</a></li><li><a href="module-FileEnterpriseAttrib.html">FileEnterpriseAttrib</a></li><li><a href="module-FileGtiAttrib.html">FileGtiAttrib</a></li><li><a href="module-FileProvider.html">FileProvider</a></li><li><a href="module-FileRepChangeEventProp.html">FileRepChangeEventProp</a></li><li><a href="module-FileReputationProp.html">FileReputationProp</a></li><li><a href="module-FirstInstanceEventProp.html">FirstInstanceEventProp</a></li><li><a href="module-FirstRefProp.html">FirstRefProp</a></li><li><a href="module-HashType.html">HashType</a></li><li><a href="module-RepChangeEventProp.html">RepChangeEventProp</a></li><li><a href="module-TrustLevel.html">TrustLevel</a></li></ul><h3>Externals</h3><ul><li><a href="external-DxlClient.html">DxlClient</a></li><li><a href="external-Event.html">Event</a></li></ul><h3>Classes</h3><ul><li><a href="TieClient.html">TieClient</a></li></ul><h3>Tutorials</h3><ul><li><a href="tutorial-installation.html">Library Installation</a></li><li><a href="tutorial-samples.html">Samples</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a>
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>