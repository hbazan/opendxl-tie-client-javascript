<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: constants/file-enterprise-attrib.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: constants/file-enterprise-attrib.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @module FileEnterpriseAttrib
 * @description Attributes associated with `file reputations` returned by the
 * Enterprise `reputation provider`.
 *
 * | Name                  | Numeric | Description |
 * | --------------------- | ------- | ----------- |
 * | PREVALENCE            | 2101652 | The count of unique systems that have executed the file. |
 * | FIRST_CONTACT         | 2102165 | The time the file was first seen (Epoch time). |
 * | ENTERPRISE_SIZE       | 2111893 | The count of systems within the local enterprise. |
 * | MIN_LOCAL_REP         | 2112148 | The lowest reputation found locally on a system. |
 * | MAX_LOCAL_REP         | 2112404 | The highest reputation found locally on a system. |
 * | AVG_LOCAL_REP         | 2112660 | The average reputation found locally on systems. |
 * | PARENT_MIN_LOCAL_REP  | 2112916 | The lowest reputation for the parent found locally on a system. |
 * | PARENT_MAX_LOCAL_REP  | 2113172 | The highest reputation for the parent found locally on a system. |
 * | PARENT_AVG_LOCAL_REP  | 2113428 | The average reputation for the parent found locally on systems. |
 * | DETECTION_COUNT       | 2113685 | The count of detections for the file or certificate. |
 * | LAST_DETECTION_TIME   | 2113942 | The last time a detection occurred (Epoch time). |
 * | FILE_NAME_COUNT       | 2114965 | The count of unique file names for the file. |
 * | IS_PREVALENT          | 2123156 | Whether the file is considered to be `prevalent` within the enterprise. |
 * | PARENT_FILE_REPS      | 2138264 | The parent file reputations (aggregate string). |
 * | CHILD_FILE_REPS       | 2138520 | The child file reputations (aggregate string). |
 * | SERVER_VERSION        | 2139285 | The version of the TIE server that returned the `reputations` (encoded version string). |
 */

'use strict'

var Buffer = require('safe-buffer').Buffer
var EnterpriseAttrib = require('./enterprise-attrib')

module.exports = {
  /**
   * The count of unique systems that have executed the file.
   */
  PREVALENCE: '2101652',
  /**
   * The time the file was first seen (Epoch time).
   *
   * See the [EpochUtil]{@link module:EpochUtil} module for helper methods used
   * to parse the Epoch time.
   */
  FIRST_CONTACT: '2102165',
  /**
   * The count of systems within the local enterprise.
   */
  ENTERPRISE_SIZE: '2111893',
  /**
   * The lowest reputation found locally on a system.
   */
  MIN_LOCAL_REP: '2112148',
  /**
   * The highest reputation found locally on a system.
   */
  MAX_LOCAL_REP: '2112404',
  /**
   * The average reputation found locally on systems.
   */
  AVG_LOCAL_REP: '2112660',
  /**
   * The lowest reputation for the parent found locally on a system.
   */
  PARENT_MIN_LOCAL_REP: '2112916',
  /**
   * The highest reputation for the parent found locally on a system.
   */
  PARENT_MAX_LOCAL_REP: '2113172',
  /**
   * The average reputation for the parent found locally on systems.
   */
  PARENT_AVG_LOCAL_REP: '2113428',
  /**
   * The count of detections for the file or certificate.
   */
  DETECTION_COUNT: '2113685',
  /**
   * The last time a detection occurred (Epoch time).
   *
   * See the [EpochUtil]{@link module:EpochUtil} module for helper methods used
   * to parse the Epoch time.
   */
  LAST_DETECTION_TIME: '2113942',
  /**
   * The count of unique file names for the file.
   */
  FILE_NAME_COUNT: '2114965',
  /**
   * Whether the file is considered to be `prevalent` within the enterprise.
   */
  IS_PREVALENT: '2123156',
  /**
   * The parent file reputations (aggregate string).
   *
   * Use the
   * [toAggregateArray]{@link module:FileEnterpriseAttrib.toAggregateArray}
   * helper function to parse this attribute.
   */
  PARENT_FILE_REPS: '2138264',
  /**
   * The child file reputations (aggregate string).
   *
   * Use the
   * [toAggregateArray]{@link module:FileEnterpriseAttrib.toAggregateArray}
   * helper function to parse this attribute.
   */
  CHILD_FILE_REPS: '2138520',
  /**
   * The version of the TIE server that returned the `reputations` (encoded
   * version string).
   *
   * See the [toVersionArray]{@link module:FileEnterpriseAttrib.toVersionArray}
   * and [toVersionString]{@link module:FileEnterpriseAttrib.toVersionString}
   * helper methods used to parse the encoded version string.
   */
  SERVER_VERSION: EnterpriseAttrib.SERVER_VERSION,
  /**
   * Returns an array of version values corresponding to the specified encoded
   * version string. This method will return an array containing the server
   * version values in the following order:
   *
   * * The major version
   * * The minor version
   * * The patch version
   * * The build version
   *
   * For example, for a `versionAttrib` value of "73183493944770750", this
   * would return:
   *
   * ```js
   * [1, 4, 0, 190]
   * ```
   *
   * * Major version: 1
   * * Minor version: 4
   * * Patch version: 0
   * * Build version: 190
   *
   * @example
   * var entRep = reputationsObj[FileProvider.ENTERPRISE]
   * var entRepAttribs = entRep[FileReputationProp.ATTRIBUTES]
   * var versionArray = FileEnterpriseAttrib.toVersionArray(
   *   entRepAttribs[FileEnterpriseAttrib.SERVER_VERSION])
   * @param {String} versionAttrib - The encoded version string
   * @returns {Array&lt;Number>} - An array corresponding to the specified
   *   encoded version string
   */
  toVersionArray: function (versionAttrib) {
    return EnterpriseAttrib.toVersionArray(versionAttrib)
  },
  /**
   * Returns a version string corresponding to the specified encoded version
   * string.
   *
   * For example, for a `versionAttrib` value of "73183493944770750", this would
   * return "1.4.0.190".
   *
   * @example
   * var entRep = reputationsObj[FileProvider.ENTERPRISE]
   * var entRepAttribs = entRep[FileReputationProp.ATTRIBUTES]
   * var versionArray = FileEnterpriseAttrib.toVersionString(
   *   entRepAttribs[FileEnterpriseAttrib.SERVER_VERSION])
   * @param {String} versionAttrib - The encoded version string
   * @returns {String} - A version string corresponding to the specified encoded
   *   version string
   */
  toVersionString: function (versionAttrib) {
    return EnterpriseAttrib.toVersionString(versionAttrib)
  },
  /**
   * Returns an array containing the values from the specified aggregate string.
   * This method will return an array containing the values that were in the
   * aggregate string in the following order:
   *
   * * The count of files
   * * The maximum `trust level` found across the files
   * * The minimum `trust level` found across the files
   * * The `trust level` for the last file
   * * The average `trust level` across the files
   *
   * For example, for a `aggregateAttrib` value of "AgBkADIAZABMHQ==", this
   * would return:
   *
   * ```js
   * [2, 100, 50, 100, 75]
   * ```
   * * Count of files: 2
   * * Maximum `trust level` found across the files: 100
   * * Minimum `trust level` found across the files: 50
   * * `Trust level` for the last file: 100
   * * Average `trust level` across the files: 75
   *
   * @example
   * var entRep = reputations_dict[FileProvider.ENTERPRISE]
   * var entRepAttribs = entRep[FileReputationProp.ATTRIBUTES]
   * var aggregateArray = FileEnterpriseAttrib.toAggregateArray(
   *   entRepAttribs[FileEnterpriseAttrib.CHILD_FILE_REPS])
   * @param {String} aggregateAttrib - The aggregate string
   * @returns {Array&lt;Number>} - An array containing the values in the specified
   *   aggregate string.
   */
  toAggregateArray: function (aggregateAttrib) {
    var decodedAttrib = Buffer.from(aggregateAttrib, 'base64')
    var returnValue = []
    for (var i = 0; i &lt; decodedAttrib.length; i += 2) {
      returnValue.push((decodedAttrib[i] + (256 * decodedAttrib[i + 1])))
    }
    if (returnValue[4] > 0) {
      returnValue[4] /= 100
    }
    return returnValue
  }
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-AtdAttrib.html">AtdAttrib</a></li><li><a href="module-AtdTrustLevel.html">AtdTrustLevel</a></li><li><a href="module-CertEnterpriseAttrib.html">CertEnterpriseAttrib</a></li><li><a href="module-CertGtiAttrib.html">CertGtiAttrib</a></li><li><a href="module-CertProvider.html">CertProvider</a></li><li><a href="module-CertRepChangeEventProp.html">CertRepChangeEventProp</a></li><li><a href="module-CertReputationOverriddenProp.html">CertReputationOverriddenProp</a></li><li><a href="module-CertReputationProp.html">CertReputationProp</a></li><li><a href="module-DetectionEventProp.html">DetectionEventProp</a></li><li><a href="module-EpochUtil.html">EpochUtil</a></li><li><a href="module-FileEnterpriseAttrib.html">FileEnterpriseAttrib</a></li><li><a href="module-FileGtiAttrib.html">FileGtiAttrib</a></li><li><a href="module-FileProvider.html">FileProvider</a></li><li><a href="module-FileRepChangeEventProp.html">FileRepChangeEventProp</a></li><li><a href="module-FileReputationProp.html">FileReputationProp</a></li><li><a href="module-FirstInstanceEventProp.html">FirstInstanceEventProp</a></li><li><a href="module-FirstRefProp.html">FirstRefProp</a></li><li><a href="module-HashType.html">HashType</a></li><li><a href="module-RepChangeEventProp.html">RepChangeEventProp</a></li><li><a href="module-TrustLevel.html">TrustLevel</a></li></ul><h3>Externals</h3><ul><li><a href="external-DxlClient.html">DxlClient</a></li><li><a href="external-Event.html">Event</a></li></ul><h3>Classes</h3><ul><li><a href="TieClient.html">TieClient</a></li></ul><h3>Tutorials</h3><ul><li><a href="tutorial-installation.html">Library Installation</a></li><li><a href="tutorial-samples.html">Samples</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a>
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
